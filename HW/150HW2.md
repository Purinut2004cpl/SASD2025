<h1>Code Smell: Middle Man</h1>
<H2>ความหมายของ Middle Man</H2>

Middle Man คือ Code Smell ประเภทหนึ่งที่เกิดขึ้นเมื่อมีคลาสทำหน้าที่เป็นเพียง
“ตัวกลางในการส่งต่อคำสั่ง” ไปยังอีกคลาสหนึ่งเท่านั้น โดยที่ตัวมันเอง ไม่มี business logic ของตัวเองเลย

<h3>ลักษณะเด่นคือ</h3>
Method ภายในคลาสแค่เรียกเมธอดของคลาสอื่นไม่มีการประมวลผลข้อมูลเพิ่มเติมเพิ่มความซับซ้อนโดยไม่จำเป็น
<h3>ผลเสียคือ</h3>
ทำให้โค้ดยาวขึ้นโดยไม่จำเป็น
อ่านโค้ดยาก เพราะต้องไล่หลายคลาส
เพิ่มภาระในการดูแลระบบ

<h3>ตัวอย่างโค้ดที่เกิด Code Smell (Middle Man)</h3>

```class PriceService:
    def get_price(self):
        return 100

class Product:
    def __init__(self):
        self.service = PriceService()

    def get_price(self):
        # ทำหน้าที่แค่ส่งต่อ
        return self.service.get_price()
```
<h3>ปัญหา</h3>

* คลาส Product ไม่ได้เพิ่ม logic ใด ๆ
* มีไว้เพียงเพื่อเรียก PriceService.get_price()
* ผู้ใช้โค้ดต้องเรียกผ่านหลายชั้นโดยไม่จำเป็น

<h3>ตัวอย่างโค้ดหลัง Refactoring</h3>
แนวทางแก้ไขหลักคือ Inline Class
(ยุบคลาสตัวกลางออก แล้วเรียกใช้งานโดยตรง)
<br>

```
class Product:
    def get_price(self):
        return 100
```

<h3>ผลลัพธ์หลัง Refactor</h3>

* โค้ดสั้นลง
* อ่านง่ายขึ้น
* ลดความซับซ้อนของโครงสร้างระบบ
* ไม่มีคลาสที่ทำหน้าที่เป็น “ทางผ่าน”

<h3>กรณีที่ Middle Man ไม่ได้บ่งบอกว่าโค้ดมีปัญหา</h3>
แม้ Middle Man จะเป็น Code Smell แต่ ไม่ใช่ทุกกรณีที่ต้อง Refactor
<h3> กรณีที่ 1: เพื่อรองรับการเปลี่ยนแปลงในอนาคต </h3>

```
class PaymentGateway:
    def pay(self, amount):
        print("Paying...")
```

ปัจจุบันอาจดูเหมือนเป็นตัวกลาง
แต่ในอนาคตอาจเพิ่มระบบ
* Credit Card
* PromptPay
* Wallet
การแยกไว้ก่อนช่วยให้ขยายระบบได้ง่าย

<h3>กรณีที่ 2: ใช้ตาม Architecture เช่น MVC หรือ Clean Architecture</h3>

```
class UserController:
    def get_user(self):
        return self.service.get_user()
```

แม้ Controller จะส่งต่อคำสั่งเป็นหลัก
แต่มีหน้าที่ชัดเจนในการควบคุม flow ของระบบ
จึง ไม่ควรถูกมองว่าเป็นปัญหา

<h3>กรณีที่ 3: เพื่อความชัดเจนของโค้ด (Readability)</h3>
การมีคลาสตัวกลางบางครั้งช่วยให้เข้าใจระบบง่ายขึ้น
แม้ logic จะยังไม่มากก็ตาม 
